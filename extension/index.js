(()=>{"use strict";var e={969:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.currentPrimary=void 0,r.currentPrimary=function(e){var r=new e.Logger("currentPrimary"),n=e.Replicant("surroundCurrentPk",{defaultValue:{prev:null,current:null,next:null}}),t=e.Replicant("programs");e.listenFor("current.update",(function(e,a){var o=e.pk;if(!a||!a.handled)try{!function(e){var r,a;if(t.value){var o=t.value.findIndex((function(r){return r.pk===e}));if(o>-1){var i=(null===(r=t.value.find((function(e,r){return r===o-1})))||void 0===r?void 0:r.pk)||null,u=(null===(a=t.value.find((function(e,r){return r===o+1})))||void 0===a?void 0:a.pk)||null;n.value={prev:i,current:e,next:u}}}}(o)}catch(e){r.error(e),a&&a(e)}}))}},700:(e,r,n)=>{var t=n(969),a=n(29);e.exports=function(e){a.programs(e),t.currentPrimary(e)}},757:(e,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.makeEntitiesFromDataValues=r.timeStringToSeconds=r.googleSpreadsheetUrlToId=void 0;var t=n(835);r.googleSpreadsheetUrlToId=function(e){return new t.URL(e).pathname.split("/")[3]||""},r.timeStringToSeconds=function(e){var r=e.split(":");return 3600*parseInt(r[0])+60*parseInt(r[1])+parseInt(r[2])},r.makeEntitiesFromDataValues=function(e){var r=e[0];return e.filter((function(e,r){return r>0})).map((function(e){return Object.fromEntries(r.map((function(r,n){return[r,e[n]]})))}))}},29:function(e,r,n){var t=this&&this.__awaiter||function(e,r,n,t){return new(n||(n=Promise))((function(a,o){function i(e){try{l(t.next(e))}catch(e){o(e)}}function u(e){try{l(t.throw(e))}catch(e){o(e)}}function l(e){var r;e.done?a(e.value):(r=e.value,r instanceof n?r:new n((function(e){e(r)}))).then(i,u)}l((t=t.apply(e,r||[])).next())}))},a=this&&this.__generator||function(e,r){var n,t,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,t&&(a=2&o[0]?t.return:o[0]?t.throw||((a=t.return)&&a.call(t),0):t.next)&&!(a=a.call(t,o[1])).done)return a;switch(t=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,t=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=r.call(e,i)}catch(e){o=[6,e],t=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.programs=void 0;var o=n(944),i=n(757);r.programs=function(e){var r=new e.Logger("programs"),n=e.Replicant("programs",{defaultValue:[]}),u=e.bundleConfig.google.apiKey,l=o.google.sheets({version:"v4",auth:u}),s=i.googleSpreadsheetUrlToId(e.bundleConfig.google.spreadsheetUri);if(""===s)throw new Error("Spreadsheet URL is invalid.");var c=null,p=function(){return t(void 0,void 0,void 0,(function(){var e,t,o,u,p,d,v,f,m,g;return a(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,l.spreadsheets.values.batchGet({spreadsheetId:s,ranges:["schedules","commentators"]})];case 1:if(e=a.sent(),t=null===(f=null===(v=e.data.valueRanges)||void 0===v?void 0:v.find((function(e){var r;return null===(r=e.range)||void 0===r?void 0:r.includes("schedules")})))||void 0===f?void 0:f.values,o=null===(g=null===(m=e.data.valueRanges)||void 0===m?void 0:m.find((function(e){var r;return null===(r=e.range)||void 0===r?void 0:r.includes("commentators")})))||void 0===g?void 0:g.values,!t||!o)throw new Error("Invalid spreadsheet values.");return u=i.makeEntitiesFromDataValues(t),p=i.makeEntitiesFromDataValues(o),n.value=u.map((function(e){var r=e.player.split(",").map((function(e){return{name:e.trim()}})),n=p.filter((function(r){return r.programPk===e.pk})).map((function(e){return{name:e.name}}));return{pk:parseInt(e.pk),name:e.program,game:e.game,players:r,commentators:n,estimate:e.estimate,estimateRawSeconds:i.timeStringToSeconds(e.estimate)}})),[3,3];case 2:return d=a.sent(),r.error(d),c&&clearInterval(c),[3,3];case 3:return[2]}}))}))};p(),c=setInterval(p,3e4)}},944:e=>{e.exports=require("googleapis")},835:e=>{e.exports=require("url")}},r={},n=function n(t){var a=r[t];if(void 0!==a)return a.exports;var o=r[t]={exports:{}};return e[t].call(o.exports,o,o.exports,n),o.exports}(700);module.exports=n})();